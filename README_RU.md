# üö™ –°–µ—Ä–≤–∏—Å –æ–±–æ–≥–∞—â–µ–Ω–∏—è –≤—Ö–æ–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–°–µ—Ä–≤–∏—Å –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –≤—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL.

---

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- üõ† **Kotlin + Ktor + Exposed** ‚Äî –¥–ª—è REST API, –ª–æ–≥–∏–∫–∏ –∏ —Ä–∞–±–æ—Ç—ã —Å –ë–î  
- üßµ **Apache Kafka** ‚Äî –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π  
- üóÉ **PostgreSQL** ‚Äî —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ `user_id` (—á–µ—Ç–Ω—ã–µ/–Ω–µ—á–µ—Ç–Ω—ã–µ)  
- üê≥ **Docker Compose** ‚Äî –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã  

---

## ‚öôÔ∏è –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

1. üê≥ **Docker Desktop** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞–∑–æ–≤ –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤  
2. üí° **IDE** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è **IntelliJ IDEA** –æ—Ç JetBrains) ‚Äî –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
3. üì¨ **Postman** ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤  
4. üåê **–ë—Ä–∞—É–∑–µ—Ä** ‚Äî –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ **Kafdrop** –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–ø–∏–∫–æ–≤ Kafka  

---

## üöÄ –ó–∞–ø—É—Å–∫

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã Docker Desktop –∏ Docker Compose.

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker Desktop, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:
```bash
docker-compose up -d
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç:
```bash
docker-compose ps
```
–∏–ª–∏ —á–µ—Ä–µ–∑ Docker Desktop (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 5 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `Running` ‚Äî –∑–µ–ª—ë–Ω—ã–π –∫—Ä—É–∂–æ–∫)

**–°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:**
- `shard1`  
- `shard2`  
- `zookeeper`  
- `kafka`  
- `kafdrop`  

---

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –≤–∞—à–µ–π IDE (–í—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ - —Ñ–∞–π–ª `Application.kt` –º–µ—Ç–æ–¥ `main()`).

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Postman**  
2. –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥ `POST`  
3. –í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å: `http://localhost:8282/api/user/login`  
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É `Body` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ `raw` –∏ —Ñ–æ—Ä–º–∞—Ç `JSON`  
5. –í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–∏–º–µ—Ä:
```json
{
    "userId": 5,
    "ipAddress": "192.168.4.4",
    "timestamp": "2024-01-01T12:00:00Z"
}
```
6. –ù–∞–∂–º–∏—Ç–µ `Send`  
7. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ: `Login event sent to Kafka`

---

8. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä –ø–æ –∞–¥—Ä–µ—Å—É: [http://localhost:9000](http://localhost:9000)  
–û—Ç–∫—Ä–æ–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å **Kafdrop**  
–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ ‚Äî –Ω–∞–π–¥–∏—Ç–µ —Ç–æ–ø–∏–∫–∏:
- `user-logins`
- `enriched-user-logins`
–ï—Å–ª–∏ –≤—ã –Ω–µ –≤–∏–¥–∏—Ç–µ —Ç–æ–ø–∏–∫–æ–≤ - –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω—Ü–∏—É.
–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π —Ç–æ–ø–∏–∫ ‚Üí –∫–ª–∏–∫–Ω–∏—Ç–µ `View Messages` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ `All messages` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π.

---

## üß© –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å **–Ω–µ—á—ë—Ç–Ω—ã–º–∏ ID** —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `users_shard1`  
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å **—á—ë—Ç–Ω—ã–º–∏ ID** —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `users_shard2`  

---

## üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ IDE  
2. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
```bash
docker-compose down -v
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `src/main/kotlin/` ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
- `docker-compose.yml` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose  
- `shard1/init.sql`, `shard2/init.sql` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö  
